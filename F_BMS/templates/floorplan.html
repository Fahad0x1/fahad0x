<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home Floorplan</title>
  <style>
    body {
      margin: 0;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .floorplan {
      position: relative;
      background: url("/static/floorplan/floorplan.png") no-repeat center/contain;
      width: 90vw;
      height: 90vh;
    }
    .element {
      position: absolute;
      cursor: pointer;
      transition: transform 0.2s;
      font-size: 24px;
    }
    .element:hover {
      transform: scale(1.3);
    }
  </style>
</head>
<body>
  <div class="floorplan">

    <!-- Lights -->
    <!-- <div class="element" style="top:10%; left:39%" onclick="toggleEntity('switch.sonoff_ab400002a4_1')">ğŸ’¡</div>
    <div class="element" style="top:15%; left:16%" onclick="toggleEntity('switch.sonoff_ab400002a6_1')">ğŸ’¡</div>
    <div class="element" style="top:15%; left:20%" onclick="toggleEntity('switch.sonoff_ab400002a6_2')">ğŸ’¡</div>
    <div class="element" style="top:36%; left:16%" onclick="toggleEntity('switch.sonoff_ab400002a3_2')">ğŸ’¡</div>
    <div class="element" style="top:73%; left:45%" onclick="toggleEntity('switch.sonoff_ab400002a9_2')">ğŸ’¡</div>
    <div class="element" style="top:35%; left:7%" onclick="toggleEntity('switch.sonoff_ab400002a2_3')">ğŸ’¡</div>
    <div class="element" style="top:86%; left:6%" onclick="toggleEntity('switch.sonoff_ab400002a2_4')">ğŸ’¡</div>
    <div class="element" style="top:75%; left:20%" onclick="toggleEntity('switch.sonoff_ab400002a6_3')">ğŸ’¡</div>
    <div class="element" style="top:38%; left:28%" onclick="toggleEntity('switch.sonoff_ab400002a4_3')">ğŸ’¡</div>
    <div class="element" style="top:12%; left:87%" onclick="toggleEntity('switch.sonoff_ab4000029f_1')">ğŸ’¡</div>
    <div class="element" style="top:12%; left:80%" onclick="toggleEntity('switch.sonoff_ab4000029f_3')">ğŸ’¡</div>
    <div class="element" style="top:12%; left:74%" onclick="toggleEntity('switch.sonoff_ab4000029f_4')">ğŸ’¡</div>
    <div class="element" style="top:12%; left:66%" onclick="toggleEntity('switch.sonoff_ab4000029f_2')">ğŸ’¡</div>
    <div class="element" style="top:44%; left:59%" onclick="toggleEntity('switch.sonoff_ab400002a7_4')">ğŸ’¡</div>
    <div class="element" style="top:37%; left:44%" onclick="toggleEntity('switch.sonoff_ab400002a1_1')">ğŸ’¡</div>
    <div class="element" style="top:29%; left:69%" onclick="toggleEntity('switch.sonoff_ab4000028a_1')">ğŸ’¡</div>
    <div class="element" style="top:28%; left:78%" onclick="toggleEntity('switch.sonoff_ab400002a9_3')">ğŸ’¡</div>
    <div class="element" style="top:40%; left:69%" onclick="toggleEntity('switch.sonoff_ab400002a5_3')">ğŸ’¡</div>
    <div class="element" style="top:52%; left:78%" onclick="toggleEntity('switch.sonoff_ab400002a5_4')">ğŸ’¡</div>
    <div class="element" style="top:40%; left:78%" onclick="toggleEntity('switch.sonoff_ab400002a0_1')">ğŸ’¡</div>
    <div class="element" style="top:52%; left:69%" onclick="toggleEntity('switch.sonoff_ab400002a0_2')">ğŸ’¡</div>
    <div class="element" style="top:62%; left:78%" onclick="toggleEntity('switch.sonoff_ab400002a9_1')">ğŸ’¡</div>
    <div class="element" style="top:62%; left:75%" onclick="toggleEntity('switch.sonoff_ab400002a5_2')">ğŸ’¡</div>
    <div class="element" style="top:82%; left:54%" onclick="toggleEntity('switch.sonoff_ab400002a1_3')">ğŸ’¡</div>
    <div class="element" style="top:82%; left:84%" onclick="toggleEntity('switch.sonoff_ab4000029e_3')">ğŸ’¡</div>
    <div class="element" style="top:82%; left:70%" onclick="toggleEntity('switch.sonoff_ab400002a3_4')">ğŸ’¡</div>
    <div class="element" style="top:82%; left:77%" onclick="toggleEntity('switch.sonoff_ab4000029e_2')">ğŸ’¡</div>
    <div class="element" style="top:66%; left:63%" onclick="toggleEntity('switch.sonoff_ab400002a1_4')">ğŸ’¡</div>
    <div class="element" style="top:65%; left:69%" onclick="toggleEntity('switch.sonoff_ab400002a4_2')">ğŸ’¡</div> -->
 <!-- Lights -->
    <div class="element" style="top:8%; left:34%" onclick="toggleEntity('switch.sonoff_ab400002a4_1')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:11%" onclick="toggleEntity('switch.sonoff_ab400002a6_1')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:20%" onclick="toggleEntity('switch.sonoff_ab400002a6_2')">ğŸ’¡</div>
    <div class="element" style="top:34%; left:16%" onclick="toggleEntity('switch.sonoff_ab400002a3_2')">ğŸ’¡</div>
    <div class="element" style="top:71%; left:40%" onclick="toggleEntity('switch.sonoff_ab400002a9_2')">ğŸ’¡</div>
    <div class="element" style="top:33%; left:2%" onclick="toggleEntity('switch.sonoff_ab400002a2_3')">ğŸ’¡</div>
    <div class="element" style="top:84%; left:1%" onclick="toggleEntity('switch.sonoff_ab400002a2_4')">ğŸ’¡</div>
    <div class="element" style="top:73%; left:20%" onclick="toggleEntity('switch.sonoff_ab400002a6_3')">ğŸ’¡</div>
    <div class="element" style="top:39%; left:27%" onclick="toggleEntity('switch.sonoff_ab400002a4_3')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:74%" onclick="toggleEntity('switch.sonoff_ab4000029f_1')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:68%" onclick="toggleEntity('switch.sonoff_ab4000029f_3')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:63%" onclick="toggleEntity('switch.sonoff_ab4000029f_4')">ğŸ’¡</div>
    <div class="element" style="top:13%; left:56%" onclick="toggleEntity('switch.sonoff_ab4000029f_2')">ğŸ’¡</div>
    <div class="element" style="top:42%; left:59%" onclick="toggleEntity('switch.sonoff_ab400002a7_4')">ğŸ’¡</div>
    <div class="element" style="top:35%; left:40%" onclick="toggleEntity('switch.sonoff_ab400002a1_1')">ğŸ’¡</div>
    <div class="element" style="top:27%; left:69%" onclick="toggleEntity('switch.sonoff_ab4000028a_1')">ğŸ’¡</div>
    <div class="element" style="top:26%; left:77%" onclick="toggleEntity('switch.sonoff_ab400002a9_3')">ğŸ’¡</div>
    <div class="element" style="top:38%; left:69%" onclick="toggleEntity('switch.sonoff_ab400002a5_3')">ğŸ’¡</div>
    <div class="element" style="top:50%; left:77%" onclick="toggleEntity('switch.sonoff_ab400002a5_4')">ğŸ’¡</div>
    <div class="element" style="top:38%; left:77%" onclick="toggleEntity('switch.sonoff_ab400002a0_1')">ğŸ’¡</div>
    <div class="element" style="top:50%; left:69%" onclick="toggleEntity('switch.sonoff_ab400002a0_2')">ğŸ’¡</div>
    <div class="element" style="top:60%; left:77%" onclick="toggleEntity('switch.sonoff_ab400002a9_1')">ğŸ’¡</div>
    <div class="element" style="top:60%; left:70%" onclick="toggleEntity('switch.sonoff_ab400002a5_2')">ğŸ’¡</div>
    <div class="element" style="top:80%; left:49%" onclick="toggleEntity('switch.sonoff_ab400002a1_3')">ğŸ’¡</div>
    <div class="element" style="top:80%; left:65%" onclick="toggleEntity('switch.sonoff_ab4000029e_3')">ğŸ’¡</div>
    <div class="element" style="top:80%; left:55%" onclick="toggleEntity('switch.sonoff_ab400002a3_4')">ğŸ’¡</div>
    <div class="element" style="top:80%; left:60%" onclick="toggleEntity('switch.sonoff_ab4000029e_2')">ğŸ’¡</div>
    <div class="element" style="top:54%; left:58%" onclick="toggleEntity('switch.sonoff_ab400002a1_4')">ğŸ’¡</div>
    <div class="element" style="top:63%; left:54%" onclick="toggleEntity('switch.sonoff_ab400002a4_2')">ğŸ’¡</div>

    <!-- Doors -->
    <div class="element" style="top:49%; left:40%; transform: scale(1.5)" onclick="toggleEntity('switch.sonoff_1001f1ee4a')">ğŸšª</div>
    <div class="element" style="top:55%; left:44%" onclick="toggleEntity('switch.sonoff_1001f1ee4a')">ğŸšª</div>
    <div class="element" style="top:55%; left:35%" onclick="toggleEntity('switch.sonoff_1001f1ee4a')">ğŸšª</div>

    <div class="element" style="top:45%; left:73%; width:50px; height:50px; line-height:50px; border-radius:50%; background-color: rgba(255,255,255,0.0); transform: scale(1.5)">ğŸšª</div>
    <div class="element" style="top:75%; left:7%" onclick="toggleEntity('script.1708014031917')">ğŸšª</div>
    <div class="element" style="top:40%; left:7%" onclick="toggleEntity('script.1709208919303')">ğŸšª</div>
    <div class="element" style="top:73%; left:55%" onclick="toggleEntity('script.1709208983300')">ğŸšª</div>
    <div class="element" style="top:75%; left:60%" onclick="toggleEntity('script.1709208954574')">ğŸšª</div>
    <div class="element" style="top:76%; left:51%" onclick="toggleEntity('script.1709208997961')">ğŸšª</div>
    <div class="element" style="top:73%; left:66%" onclick="toggleEntity('script.1709212134770')">ğŸšª</div>
    <div class="element" style="top:63%; left:68%" onclick="toggleEntity('script.lock26_duplicate')">ğŸšª</div>
    <div class="element" style="top:53%; left:68%" onclick="toggleEntity('script.lock25_duplicate')">ğŸšª</div>
    <div class="element" style="top:43%; left:68%" onclick="toggleEntity('script.lock24_duplicate')">ğŸšª</div>
    <div class="element" style="top:33%; left:68%" onclick="toggleEntity('script.lock23_duplicate')">ğŸšª</div>
    <div class="element" style="top:58%; left:54%" onclick="toggleEntity('script.1709212152765')">ğŸšª</div>
    <div class="element" style="top:48%; left:54%" onclick="toggleEntity('script.lock20_duplicate')">ğŸšª</div>
    <div class="element" style="top:67%; left:53%" onclick="toggleEntity('script.lock14_duplicate')">ğŸšª</div>
    <div class="element" style="top:36%; left:55%" onclick="toggleEntity('script.lock21_duplicate')">ğŸšª</div>
    <div class="element" style="top:27%; left:55%" onclick="toggleEntity('script.lock22_duplicate')">ğŸšª</div>
    <div class="element" style="top:18%; left:71%" onclick="toggleEntity('script.lock10_duplicate')">ğŸšª</div>
    <div class="element" style="top:18%; left:65%" onclick="toggleEntity('script.lock11_duplicate')">ğŸšª</div>
    <div class="element" style="top:18%; left:60%" onclick="toggleEntity('script.lock12_duplicate')">ğŸšª</div>
    <div class="element" style="top:18%; left:57%" onclick="toggleEntity('script.lock13_duplicate')">ğŸšª</div>

    <!-- Curtains -->
    <!-- <div class="element" style="top:41%; left:88%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:76%; left:74%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:23%; left:70%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:89%; left:20%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:58%; left:2%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:8%; left:20%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div>
    <div class="element" style="top:23%; left:1%" onclick="toggleEntity('script.1708014031917')">ğŸ”ºğŸ”»</div> -->

  </div>

  <script>
    function toggleEntity(entityId) {
      fetch(`/toggle/${entityId}`, { method: 'POST' })
        .then(res => res.json())
        .then(data => {
          if(data.status === "success"){
            console.log(entityId + " toggled");
          } else {
            console.error(data.details);
          }
        });
    }
  </script>
</body>

<!-- <script>
  // ÙŠØºÙŠØ± Ø´ÙƒÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø©
  function updateIcon(element, state) {
    if (state === "on") {
      element.style.opacity = "1";   // Ù…Ù†ÙˆØ±Ø©
      element.textContent = "ğŸ’¡";    // Ù„Ù…Ø¨Ø© Ø´ØºØ§Ù„Ø©
    } else {
      element.style.opacity = "0.3"; // Ù…Ø·ÙÙŠØ©
      element.textContent = "ğŸ’¡";    // Ù„Ù…Ø¨Ø© Ù…Ø·ÙÙŠØ©
    }
  }

  // ÙŠØ¬ÙŠØ¨ Ø­Ø§Ù„Ø© Ø¬Ù‡Ø§Ø² ÙˆØ§Ø­Ø¯
  function fetchState(entityId, element) {
    fetch(`/state/${entityId}`)
      .then(res => res.json())
      .then(data => {
        updateIcon(element, data.state);
      });
  }

  // Ù„Ù…Ø§ ÙŠØ¶ØºØ· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ±Ø³Ù„ toggle ÙˆÙŠØ­Ø¯Ø« Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
  function toggleEntity(entityId, element) {
    fetch(`/toggle/${entityId}`, { method: 'POST' })
      .then(res => res.json())
      .then(data => {
        if (data.status === "success") {
          fetchState(entityId, element);
        }
      });
  }

  // Ø¹Ù†Ø¯ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø©
  document.querySelectorAll(".element").forEach(el => {
    const entityId = el.getAttribute("onclick").match(/'(.*?)'/)[1];
    el.setAttribute("onclick", `toggleEntity("${entityId}", this)`);
    fetchState(entityId, el);
  });

  // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
  setInterval(() => {
    document.querySelectorAll(".element").forEach(el => {
      const entityId = el.getAttribute("onclick").match(/"(.*?)"/)[1];
      fetchState(entityId, el);
    });
  }, 5000);
</script> -->

</html>
